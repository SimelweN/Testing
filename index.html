<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Proper Content Security Policy -->
    <meta
      http-equiv="Content-Security-Policy"
      content="
      connect-src 'self'
        https://*.supabase.co
        https://api.paystack.co
        https://js.paystack.co
        https://www.googletagmanager.com
        https://www.google-analytics.com
        https://images.unsplash.com
        https://cdn.builder.io
        https://cdn.gpteng.co
        https://pagead2.googlesyndication.com
        https://googleads.g.doubleclick.net
        https://www.google.com
        wss: ws:;
      script-src 'self' 'unsafe-inline' 'unsafe-eval'
        https://www.googletagmanager.com
        https://js.paystack.co
        https://cdn.gpteng.co
        https://pagead2.googlesyndication.com
        https://googleads.g.doubleclick.net;
      img-src 'self' data: https:;
      style-src 'self' 'unsafe-inline' https:;
      frame-src 'self' https://googleads.g.doubleclick.net https://tpc.googlesyndication.com;
    "
    />

    <title>ReBooked Solutions - Buy and Sell Textbooks Securely</title>
    <meta
      name="description"
      content="ReBooked Solutions - Your secure platform for buying and selling used textbooks"
    />
    <meta name="author" content="ReBooked Solutions" />
    <meta name="google-adsense-account" content="ca-pub-1957085805829290">
    <!-- Favicon configuration -->
    <link
      rel="icon"
      href="https://cdn.builder.io/api/v1/assets/0f22b19c46fe46488c6c8c5a3c15b7b9/compressed_open_book_icon-adaa9a?format=ico&width=32"
      type="image/x-icon"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="https://cdn.builder.io/api/v1/assets/0f22b19c46fe46488c6c8c5a3c15b7b9/compressed_open_book_icon-adaa9a?format=png&width=32"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="https://cdn.builder.io/api/v1/assets/0f22b19c46fe46488c6c8c5a3c15b7b9/compressed_open_book_icon-adaa9a?format=png&width=16"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="https://cdn.builder.io/api/v1/assets/0f22b19c46fe46488c6c8c5a3c15b7b9/compressed_open_book_icon-adaa9a?format=png&width=180"
    />
    <link rel="manifest" href="/manifest.json" />

    <meta
      property="og:title"
      content="ReBooked Solutions - Buy and Sell Textbooks Securely"
    />
    <meta
      property="og:description"
      content="ReBooked Solutions - Your secure platform for buying and selling used textbooks"
    />
    <meta property="og:type" content="website" />
    <meta
      property="og:image"
      content="https://cdn.builder.io/api/v1/assets/0f22b19c46fe46488c6c8c5a3c15b7b9/compressed_open_book_icon-adaa9a?format=webp&width=800"
    />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@rebooked_solutions" />
    <meta
      name="twitter:image"
      content="https://cdn.builder.io/api/v1/assets/0f22b19c46fe46488c6c8c5a3c15b7b9/compressed_open_book_icon-adaa9a?format=webp&width=800"
    />

    <!-- Critical Resource Preloading for Performance -->
    <link rel="dns-prefetch" href="https://images.unsplash.com" />
    <link rel="preconnect" href="https://images.unsplash.com" crossorigin />
    <link rel="dns-prefetch" href="https://js.paystack.co" />
    <link rel="preconnect" href="https://js.paystack.co" crossorigin />

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-33V40Q5BEW"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-33V40Q5BEW");
    </script>

    <!-- Minimal error handling for development -->
    <script>
      // Only suppress known third-party extension errors that can't be controlled
      (function () {
        const originalError = console.error;
        const originalWarn = console.warn;

        const shouldSuppressError = (message) => {
          const msg = String(message || "").toLowerCase();
          return (
            // Browser extensions
            msg.includes("chrome-extension") ||
            msg.includes("moz-extension") ||
            msg.includes("safari-extension") ||
            // ResizeObserver browser quirks
            (msg.includes("resizeobserver") &&
              msg.includes("loop limit exceeded")) ||
            // Development tool errors (Vite HMR)
            msg.includes("@vite/client") ||
            msg.includes(".fly.dev") ||
            msg.includes("ping") ||
            msg.includes("waitforsuccessfulping") ||
            msg.includes("messagehandler") ||
            (msg.includes("failed to fetch") && msg.includes("eval at")) ||
            // Google Maps retry messages
            (msg.includes("failed to load google maps script") &&
              msg.includes("retrying")) ||
            msg.includes("google maps script, retrying") ||
            msg.includes("failed to load google maps script, retrying in") ||
            (msg.includes("google maps") && msg.includes("retrying"))
          );
        };

        console.error = function (...args) {
          const message = args.join(" ");
          if (!shouldSuppressError(message)) {
            originalError.apply(this, args);
          } else if (
            message.toLowerCase().includes("@vite") ||
            message.toLowerCase().includes(".fly.dev")
          ) {
            // Log development server issues as debug info
            console.debug(
              "[DEV] Suppressed:",
              message.substring(0, 100) + "...",
            );
          }
        };

        console.warn = function (...args) {
          const message = args.join(" ");
          if (!shouldSuppressError(message)) {
            originalWarn.apply(this, args);
          }
        };

        // Register service worker for error blocking only if needed
        if ("serviceWorker" in navigator) {
          navigator.serviceWorker.register("/error-block-sw.js").catch(() => {
            // Silently fail if service worker is not available
          });
        }
      })();
    </script>
  </head>

  <body>
    <div id="root"></div>

    <!-- Paystack Integration for Checkout -->
    <script src="https://js.paystack.co/v1/inline.js"></script>

    <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
